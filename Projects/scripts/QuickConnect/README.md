# ExpressLink Quick Connect Script

_WARNING : **Do not to share** the link or the QR code generated by the QuickConnect script as it contains your AWS Access keys. You need to disable the keys and generate new ones if they are shared or leaked. ST cannot be responsible for shared or leaked keys._

Quick Connect for Express link module STM32 and AWS

Supported boards
   * <a href="https://www.st.com/en/evaluation-tools/b-l4s5i-iot01a.html" target="_blank">B-L4S5I-IOT01A</a>
   * <a href="https://www.st.com/en/evaluation-tools/b-u585i-iot02a.html" target="_blank">B-U585I-IOT02A</a>
   * <a href="https://www.st.com/en/evaluation-tools/nucleo-g0b1re.html" target="_blank">NUCLEO-G0B1RE</a>
   * <a href="https://www.st.com/en/evaluation-tools/nucleo-g071rb.html" target="_blank">NUCLEO-G071RB</a>
   * <a href="https://www.st.com/en/evaluation-tools/nucleo-h503rb.html" target="_blank">NUCLEO-H503RB</a>
   * <a href="https://www.st.com/en/evaluation-tools/nucleo-h563zi.html" target="_blank">NUCLEO-H563ZI</a>
   * <a href="https://www.st.com/en/evaluation-tools/nucleo-u545re-q.html" target="_blank">NUCLEO-U545RE-Q</a>
   * <a href="https://www.st.com/en/evaluation-tools/nucleo-u575zi-q.html" target="_blank">NUCLEO-U575ZI-Q</a>
   * <a href="https://www.st.com/en/evaluation-tools/nucleo-wb55rg.html" target="_blank">NUCLEO-WB55RG</a>
   * <a href="https://www.st.com/en/evaluation-tools/stm32l562e-dk.html" target="_blank">STM32L562E-DK</a> 

The script is compatible with Windows, Linux and MAC OS

* Install [AWS CLI](https://aws.amazon.com/cli/)
* Install [python](https://www.python.org/downloads/)
* run **pip install -r requirements.txt**

* Sign in to [AWS console](https://console.aws.amazon.com/console/home)
* Create 2 IAM users
    * First user with the **AWSIoTFullAccess** policy. This IAM user will be used to register the device with AWS IoT core (used with the **default** AWS CLI profile)
    
    * Second user with the following policy (used with the **dashboard** AWS CLI profile)

```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "VisualEditor0",
            "Effect": "Allow",
            "Action": [
                "iot:Receive",
                "iot:ListNamedShadowsForThing",
                "iot:DescribeEndpoint",
                "iot:Subscribe",
                "iot:Connect",
                "iot:GetThingShadow",
                "iot:DeleteThingShadow",
                "iot:UpdateThingShadow",
                "iot:Publish"
            ],
            "Resource": [
                "arn:aws:iot:<your-region>:<your-account-number>:topic/*",
                "arn:aws:iot:<your-region>:<your-account-number>:topic/$aws/things/*",
                "arn:aws:iot:<your-region>:<your-account-number>:client/*",
                "arn:aws:iot:<your-region>:<your-account-number>:thing/*",
                "arn:aws:iot:<your-region>:<your-account-number>:topicfilter/*"
            ]
        },
        {
            "Sid": "VisualEditor1",
            "Effect": "Allow",
            "Action": "iot:DescribeEndpoint",
            "Resource": "*"
        }
    ]
}
```

_NOTE â€“ The examples in this document are intended only for dev environments. The specific permission policies can vary for your use case. Identify the permission policies that best meet your business and security requirements. For more information, see [Example IAM identity-based policies](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_examples.html) and [Security Best practices](https://docs.aws.amazon.com/IAM/latest/UserGuide/IAMBestPracticesAndUseCases.html) in the IAM Identity and Access Management User Guide.._

* Use AWS CLI to create 2 profiles (example **default** and **dashboard**)
* Connect the board to you computer
* Navigate to **.\QuickConnect\Script** directory
* Call the **STM32_AWS_ExpressLink_QuickConnect.py** as following

```
python .\STM32_AWS_ExpressLink_QuickConnect.py --provision-profile default --dashboard-profile dashboard --ssid MyWiFiSSID --password MyWiFiPasord
```

_WARNING : **Do not to share** the link or the QR code generated by the QuickConnect script as it contains your AWS Access keys. You need to disable the keys and generate new ones if they are shared or leaked. ST cannot be responsible for shared or leaked keys._